ARCHFLAGS={ARCHFLAGS}
CC={CC}
OBJCOPY={OBJCOPY}
DEBUGFLAGS={DEBUGFLAGS}
XMMSFLAGS={XMMSFLAGS}
XMMSLIBS={XMMSLIBS}
SHAREDLIBRARYFLAGS={SHAREDLIBRARYFLAGS}
CFLAGS = -Wall -O2 $(SHAREDLIBRARYFLAGS) $(DEBUGFLAGS) $(XMMSFLAGS) $(ARCHFLAGS) -I../common -I../../include
CLIBS = $(XMMSLIBS)
MODULES = plugin.o amifilemagic.o eagleplayer.o strlrep.o uadecontrol.o \
	uadeipc.o unixatomic.o subsongseek.o effects.o uadeconf.o md5.o \
	unixipc.o fileinfo.o songinfo.o
PLAYERHEADERS = ../common/eagleplayer.h ../common/uadeconf.h ../common/uadeconfstructure.h

libuade2.so:	$(MODULES)
	$(CC) $(CFLAGS) -o $@ $(MODULES) $(CLIBS)
	$(OBJCOPY) -G get_iplugin_info $@

amifilemagic.o:	../common/amifilemagic.c ../common/amifilemagic.h
	$(CC) $(CFLAGS) -c $<

eagleplayer.o:	../common/eagleplayer.c $(PLAYERHEADERS) ../common/md5.h
	$(CC) $(CFLAGS) -c $<

effects.o:	../common/effects.c ../common/effects.h
	$(CC) $(CFLAGS) -c $<

fileinfo.o:	fileinfo.c fileinfo.h
	$(CC) $(CFLAGS) -c $<

md5.o:	../common/md5.c ../common/md5.h
	$(CC) $(CFLAGS) -c $<

plugin.o:	plugin.c plugin.h subsongseek.h fileinfo.h  ../common/uadecontrol.h ../../include/uadeipc.h ../../include/uadeconstants.h subsongseek.h ../../include/uadeconfig.h ../common/effects.h ../common/md5.h $(PLAYERHEADERS)
	$(CC) $(CFLAGS) -c $<

strlrep.o:	../../strlrep.c ../../include/strlrep.h
	$(CC) $(CFLAGS) -c $<

songinfo.o:	../common/songinfo.c ../common/songinfo.h
	$(CC) $(CFLAGS) -c $<

subsongseek.o:	subsongseek.c subsongseek.h plugin.h
	$(CC) $(CFLAGS) -c $<

uadeconf.o:	../common/uadeconf.c $(PLAYERHEADERS)
	$(CC) $(CFLAGS) -c $<

uadecontrol.o:	../common/uadecontrol.c ../common/uadecontrol.h ../../include/uadeipc.h $(PLAYERHEADERS)
	$(CC) $(CFLAGS) -c $<

uadeipc.o:	../../uadeipc.c ../../include/uadeipc.h
	$(CC) $(CFLAGS) -c $<

unixatomic.o:	../../unixatomic.c ../../include/unixatomic.h
	$(CC) $(CFLAGS) -c $<

unixipc.o:	../../unixipc.c ../../include/ipcsupport.h
	$(CC) $(CFLAGS) -c $<

clean:	
	rm -f *.so *.o
