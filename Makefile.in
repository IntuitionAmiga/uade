# Top-level Makefile for UADE

MAKE = {MAKE}

FINALBINDIR = {BINDIR}
FINALDATADIR = {DATADIR}
FINALDOCDIR = {DOCDIR}
FINALMANDIR = {MANDIR}
FINALLIBDIR = {LIBDIR}

BINDIR = {PACKAGEPREFIX}{BINDIR}
DATADIR = {PACKAGEPREFIX}{DATADIR}
DOCDIR = {PACKAGEPREFIX}{DOCDIR}
MANDIR = {PACKAGEPREFIX}{MANDIR}
LIBDIR = {PACKAGEPREFIX}{LIBDIR}

all:	src/include/uadeconfig.h uadecore uade123

uadecore:	
	$(MAKE) -C src

uade123:	
	$(MAKE) -C src/frontends/uade123

src/include/uadeconfig.h:	
	@echo ""
	@echo "Run ./configure first!"
	@echo ""
	@false

soundcheck:	
	@ echo ""
	@ echo "### UADE should be playing now 'AHX.Cruisin'"
	@ echo ""
	src/frontends/uade123/uade123 --basedir=. -S amigasrc/score/score -P players/AHX -m songs/AHX.Cruisin -u src/uadecore

uninstall:	
	rm -f "$(FINALBINDIR)/uadecore"
	rm -f "$(FINALBINDIR)/uade123"
	rm -f "$(FINALLIBDIR)/uadecore"
	rm -f "$(FINALDATADIR)/uade.conf"
	rm -f "$(FINALDATADIR)/score"
	rm -f "$(FINALDATADIR)/uaerc"
	rm -f "$(FINALDATADIR)/eagleplayer.conf"
	rm -rf "$(FINALDATADIR)/players"
	rmdir "$(FINALDATADIR)" || true

install:	all
	mkdir -p "$(BINDIR)"
	mkdir -p "$(DATADIR)/players"
	mkdir -p "$(DOCDIR)"
	mkdir -p "$(MANDIR)"
	mkdir -p "$(LIBDIR)"
	chmod og+rx "$(LIBDIR)"
	test -e "$(DATADIR)/uade.conf" || cp -f uade.conf "$(DATADIR)/"
	cp -f amigasrc/score/score uaerc eagleplayer.conf "$(DATADIR)/"
	cp -rf players "$(DATADIR)/" || true
	chmod -R og+rX "$(DATADIR)"

	cp -f src/uadecore "$(LIBDIR)"/
	chmod og+rx "$(LIBDIR)/uadecore"

	cp -f src/frontends/uade123/{UADE123NAME} "$(BINDIR)/" || true
	chmod og+rx "$(BINDIR)/{UADE123NAME}"

	cp doc/uade123.1 "$(MANDIR)"/
	chmod og+r "$(MANDIR)"/uade123.1

clean:	
	$(MAKE) -C src clean
	$(MAKE) -C src/frontends/uade123 clean


